<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link href="bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="http://cdn.bootcss.com/html5shiv/3.7.0/html5shiv.min.js"></script>
        <script src="http://cdn.bootcss.com/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
    <link href="css/style.css" rel="stylesheet">
    <link href="css/fineuploader.css" rel="stylesheet">
  </head>
  <body data-spy="scroll" data-target="#menu" style="background-color:#157B48">
<div class="pagewrap">
<div class="container-fluid">
     <div class="row-fluid top">
    	<div class="span12 headimg" style="background-color:#FFF;">
        <div class="left top20 left20"><a href="" id="logo"><img src="images/logo.png" class="logoimg"/></a></div>
        <div class="right top20">
           <div class="navbar">
           	    <div class="">
		           	  <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
				        <span class="icon-bar"></span>
				        <span class="icon-bar"></span>
				        <span class="icon-bar"></span>
				      </a>
				      <div class="nav-collapse collapse">
					    <ul class="nav pull-right">
  			      		 <li><a href="/eduplat/" id="home" style="font-size: 10pt;
font-family: Microsoft Yahei,Georgia,serif;margin-top:2px;">首页</a></li>
					      <li style="margin-top:12px;margin-right:-10px;"><span id="greeting">您好！</span></li>
											<li class="usernamemargin"><a id="username"></a></li>
					     <!--  <li><a><img src="" id="userimg"/></a></li> -->
					      <!-- <li><a id="username"></a></li> -->
					    </ul>
				      </div>
			  </div>
			</div>
        </div>
   		</div>
    </div>  
<!--     <div class="row">
    <div class="span12 split"></div>
    </div> -->
    <div class="row-fluid">
    	<div class="span12 h20"></div>
    </div>
<!--     <div class="row-fluid">
    	<div class="span12 h20">
    	    <ul class="breadcrumb">
			    <li><a href="#">后台管理</a> <span class="divider">→ </span></li>
			    <li class="active">专业定义</li>
			</ul>
    	</div>
    </div> -->
    <div class="row-fluid">
    	<div class="span12 h20"></div>
    </div>
	<div class="row-fluid">
	    <div class="span2" id="menu" style="margin-left:5px;">
	    	<ul class="nav nav-pills nav-stacked">
			    <!-- <li class="active"><a href="javascript:defineprofession();">专业定义</a></li>
			    <li><a href="javascript:definecourse();">课程定义</a></li>
			    <li><a href="javascript:defineexperiment();">实验定义</a></li> -->
			    <li class="active"><a href="profession.html" id="zydef">专业定义</a></li>
			    <li><a href="course.html" id="kcdef">课程定义</a></li>
			    <li><a href="experiment.html" id="sydef">实验定义</a></li>
			</ul>
	    </div>
	    <div class="span1"></div>
	    <div class="span8">
	    	<div class="row-fluid" style="width:785px;height:375px;margin-left:-60px;">
	    		<div class="span12">
   			    	<div class="panel panel-primary">
					  <div class="panel-heading">
					    <h3 class="panel-title" id="tag1">专业定义</h3>
					  </div>
					  <div class="panel-body">
					    <form class="form-actions">
						    <label><a class="rcol">*</a>名　称：</br>
						        <input type="text" class="span12" id="zyname">
						    </label>
						    <label>介　绍：</br>
						        <textarea class="span12" rows="3" id="zydesc"></textarea>
						    </label>
						    <div class="row-fluid">
						    	<div class="span4"></div>
						    	<div class="span2"><button type="button" class="btn btn-warning" id="zyok">提交</button></div>
						    	<div class="span2"><button type="button" class="btn btn-warning" id="zycancel">取消</button></div>
						    	<div class="span4"></div>
						    </div>
						</form>
					  </div>
					</div>
	    		</div>
	    	</div>
	    	</div>
	    </div>
	    <div class="span1"></div>
    </div>
</div>
</div>
<div id="tipModal" class="modal hide fade">
    <div class="modal-header">
        <h3>提示</h3>
    </div>
    <div class="modal-body">
        <p id="tooptip"></p>
    </div>
    <div class="modal-footer">
        <button class="btn btn-info" data-dismiss="modal">关闭</button>
    </div>
</div>
 <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="bootstrap/js/jquery-1.9.1.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="js/fineuploader.js"></script>    
    <script src="js/common.js"></script>
    <script>
    var isadmin = false;
	    $(document).ready(function(){
	    	
	    	var array = parseUrl();	    	
	    	var b = array[0];
	    	
	    	if ("admin" == b)
	    	{	    		    	
	    		$("#logo").attr("href","/eduplat/");
		    	$("#username").html("管理员");	
		    	$("#userimg").attr("src","images/user.png");
		    	$("#zydef").attr("href", "/eduplat/profession.html");
    			$("#kcdef").attr("href", "/eduplat/course.html");
    			$("#sydef").attr("href", "/eduplat/experiment.html");
				$("#sethref").attr("href", "/eduplat/setting.html");
	    	}
	    	else
	    	{		    	
	    		$("#logo").attr("href","/eduplat/index.html?"+b);	
	    		$("#home").attr("href","/eduplat/index.html?"+b);
	    		$("#zydef").attr("href", "/eduplat/profession.html?"+b);
    			$("#kcdef").attr("href", "/eduplat/course.html?"+b);
    			$("#sydef").attr("href", "/eduplat/experiment.html?"+b);
		    	var username = array[2];
		    	$("#username").html(username);
		    	$("#userimg").attr("src",array[3]);		    	
	    	}
	    	
	    	$("#menu li").click(function(){
	    		$("#menu li").removeClass("active");
	    		$(this).addClass("active");
	    		
	    	});
	    	
	    	initCategory(0,0);
	    	initSelect();
	    	initcase();
			$("#zyok").click(function(){
				addcategory();
			});
			$("#zycancel").click(function(){
				cancelcategory();
			});
			$("#kcok").click(function(){
				addkc();
			});
			$("#kccancel").click(function(){
				cancelkc();
			});
			$("#syok").click(function(){
				addsy();
			});
			$("#sycancel").click(function(){
				cancelsy();
			});
			createUploader('bootstrapped-fine-uploader','kcimg');
			createUploader('bootstrapped-fine-uploader2','syimg');
			$(".nav-pills").affix({
				offset:{top:0}
			});
		});
	    function initSelect()
	    {
	    	$.ajax({
				url:"casecategory.action",
				type:"post",
				success:function(s){
					var a=eval("("+s+")");
					if (a)
					{
						var select = '';
						for(var i=0;i<a.length;i++){
			    			select += '<option value="'+a[i].id+'">'+a[i].name+'</option>';
							}							
						$("#selectcasec").html(select);
					}
				}
				});
	    }
	    function initCategory(id,ccid)
	    {
	    	$.ajax({
				url:"categorybyid.action?id="+id+"&ccid="+ccid,
				type:"post",
				success:function(s){
					var a=eval("("+s+")");
					if (a)
					{					
						var select = '';					
						for(var i=0;i<a.length;i++){
			    			select += '<option value="'+a[i].id+'">'+a[i].name+'</option>';
						}						
						$("#selectcase").html(select);			
					}
				}
				});
	    }
	    function initcase()
	    {
	    	$.ajax({
				url:"getAllcase.action",
				type:"post",
				success:function(s){
					var a=eval("("+s+")");
					if (a)
					{
						var select = '';
						for(var i=0;i<a.length;i++){
			    			select += '<option value="'+a[i].id+'">'+a[i].name+'</option>';
							}							
						$("#sytype").html(select);
					}
				}
				});
	    }
	     function defineprofession()
	    {
	    	window.location.href="profession.html";
	    }
	  /*    function definecourse()
	    {
	    	window.location.href="course.html";
	    } */
	     function defineexperiment()
	    {
	    	window.location.href="experiment.html";
	    }
	    function cancelcategory()
	    {
	    	document.getElementById("zyname").value='';
			document.getElementById("zydesc").value='';
	    }
	    function cancelkc()
	    {
	    	document.getElementById("kcname").value='';
			document.getElementById("kcimg").value='';
			document.getElementById("kcdesign").value='';
			document.getElementById("weburl").value='';
			document.getElementById("desktopurl").value='';
			document.getElementById("kcdesc").value='';
	    	document.getElementById("recommend").checked='';	    	
	    }
	    function cancelsy()
	    {
	    	document.getElementById("syname").value='';
			document.getElementById("syimg").value='';
			document.getElementById("syweburl").value='';
			document.getElementById("sydesktopurl").value='';
			document.getElementById("sydesc").value='';
	    }
	    function addcategory()
	    {
	    	var name = $("#zyname").val();
	    	var describe = $("#zydesc").val();
	    	if (isNull(name))	
			{					
				//alert("名称不能为空");
				$("#tooptip").html("名称不能为空");
	    		$("#tipModal").modal();
				return ;
			}		
	    	var data = {name:name,describe:describe};
	    	$.ajax({
				url:"addcategory.action",
				type:"post",
				data:data,
				success:function(s){
					
					if (s == "sucess")
					{						
						cancelcategory();
						//alert("增加成功");
						$("#tooptip").html("增加成功");
			    		$("#tipModal").modal();
					}
					else
					{
						//alert(s);
						$("#tooptip").html(s);
			    		$("#tipModal").modal();
					}
				}
			});
	    }
	    function addkc()
	    {
	    	var name = $("#kcname").val();
	    	var imgPath = $("#kcimg").val();
	    	var design = $("#kcdesign").val();
	    	var caseCategory = $("#selectcasec").val();
	    	var category = $("#selectcase").val();
	    	var url = $("#weburl").val();
	    	var desktopurl = $("#desktopurl").val();
	    	if (!isNull(url) && !isNull(desktopurl))
			{					
				//alert("是WEB URL还是桌面CalssId，请选填一个");
				$("#tooptip").html("是WEB URL还是桌面CalssId，请选填一个");
	    		$("#tipModal").modal();
				return ;
			}
	    	if (!isNull(url) && !isWebUrl(url))
	    	{
				$("#tooptip").html("WEB URL格式不合法，请填写http://或者https://为开头的字符串");
			    $("#tipModal").modal();
				return ;
	    	}
	    	if (!isNull(desktopurl))
    		{
	    		url = desktopurl;
    		}
	    	var describe = $("#kcdesc").val();
	    	var recommends = document.getElementById("recommend").checked;
	    	var recommend = recommends ? 1 : 0;
	    	if (isNull(name))	
			{			
				//alert("名称不能为空");
				$("#tooptip").html("名称不能为空");
	    		$("#tipModal").modal();
				return ;
			}		
	    	
	    	var data = {name:name,imgPath:imgPath,design:design,caseCategory:caseCategory,category:category,url:url,describe:describe,recommend:recommend};
	    	$.ajax({
				url:"addcase.action",
				type:"post",
				data:data,
				success:function(s){
					
					if (s == "sucess")
					{						
						cancelkc();
						//alert("增加成功");
						$("#tooptip").html("增加成功");
			    		$("#tipModal").modal();
					}
					else
					{
						//alert(s);
						$("#tooptip").html(s);
			    		$("#tipModal").modal();
					}
				}
			});
	    }
	    function addsy()
	    {
	    	var name = $("#syname").val();
	    	var imgPath = $("#syimg").val();
	    	var casetype = $("#sytype").val();
	    	var url = $("#syweburl").val();
	    	var desktopurl = $("#sydesktopurl").val();
	    	if (!isNull(url) && !isNull(desktopurl))
			{					
				//alert("是WEB URL还是桌面CalssId，请选填一个");
				$("#tooptip").html("是WEB URL还是桌面CalssId，请选填一个");
	    		$("#tipModal").modal();
				return ;
			}
	    	if (!isNull(url) && !isWebUrl(url))
	    	{
				$("#tooptip").html("WEB URL格式不合法，请填写http://或者https://为开头的字符串");
			    $("#tipModal").modal();
				return ;
	    	}
	    	if (!isNull(desktopurl))
    		{
	    		url = desktopurl;
    		}
	    	var describe = $("#sydesc").val();
	    	if (isNull(name))	
			{					
				//alert("名称不能为空");
				$("#tooptip").html("名称不能为空");
	    		$("#tipModal").modal();
				return ;
			}		
	    	
	    	var data = {name:name,imgPath:imgPath,casetype:casetype,url:url,describe:describe};
	    	$.ajax({
				url:"addcasecontent.action",
				type:"post",
				data:data,
				success:function(s){
					
					if (s == "sucess")
					{						
						cancelsy();
						//alert("增加成功");
						$("#tooptip").html("增加成功");
			    		$("#tipModal").modal();
					}
					else
					{
						//alert(s);
						$("#tooptip").html(s);
			    		$("#tipModal").modal();
					}
				}
			});
	    }
    </script>
  </body>
</html>